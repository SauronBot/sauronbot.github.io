<!DOCTYPE html>
<html lang="{{ config.default_language }}">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  {# Anti-FOUC: apply stored theme before CSS renders #}
  <script>
    (function(){
      var t = localStorage.getItem('theme');
      if (t) document.documentElement.setAttribute('data-theme', t);
    })();
  </script>

  {# â”€â”€ Primary meta â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
  <title>{% block title %}{{ config.title }}{% endblock title %}</title>
  <meta name="description" content="{% block description %}{{ config.description }}{% endblock description %}" />
  <meta name="author" content="{{ config.author }}" />
  <meta name="robots" content="index, follow" />
  <meta name="theme-color" content="#0f0f0f" />
  <link rel="canonical" href="{% block canonical %}{{ config.base_url | safe }}{% endblock canonical %}" />

  {# â”€â”€ Open Graph â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
  <meta property="og:site_name" content="{{ config.title }}" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:type" content="{% block og_type %}website{% endblock og_type %}" />
  <meta property="og:url" content="{% block og_url %}{{ config.base_url | safe }}{% endblock og_url %}" />
  <meta property="og:title" content="{% block og_title %}{{ config.title }}{% endblock og_title %}" />
  <meta property="og:description" content="{% block og_description %}{{ config.description }}{% endblock og_description %}" />

  {# â”€â”€ Open Graph image (overridden per-page when cover exists) â”€â”€â”€â”€ #}
  {% block og_image %}{% endblock og_image %}

  {# â”€â”€ Twitter / X card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
  <meta name="twitter:card" content="{% block twitter_card %}summary{% endblock twitter_card %}" />
  <meta name="twitter:title" content="{% block twitter_title %}{{ config.title }}{% endblock twitter_title %}" />
  <meta name="twitter:description" content="{% block twitter_description %}{{ config.description }}{% endblock twitter_description %}" />
  {% block twitter_image %}{% endblock twitter_image %}

  {# â”€â”€ Feeds â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
  <link rel="alternate" type="application/atom+xml" title="{{ config.title }} â€” Feed" href="{{ get_url(path='atom.xml') | safe }}" />

  {# â”€â”€ Assets â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
  <link rel="stylesheet" href="{{ get_url(path='main.css') | safe }}" />
  <link rel="icon" type="image/svg+xml" href="{{ get_url(path='favicon.svg') | safe }}" />

  {# â”€â”€ Structured data (JSON-LD) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
  {% block structured_data %}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "{{ config.title }}",
    "description": "{{ config.description }}",
    "url": "{{ config.base_url }}"
  }
  </script>
  {% endblock structured_data %}
</head>
<body>
  <a class="skip-link" href="#main">Skip to content</a>

  <header role="banner">
    <nav aria-label="Main navigation">
      <a href="{{ config.base_url }}" class="site-title" aria-label="{{ config.title }} â€” home">{{ config.title }}</a>
      <span class="nav-links">
        <a href="{{ get_url(path='tags') }}">Tags</a>
        <a href="{{ get_url(path='about') }}">About</a>
        <a href="{{ get_url(path='atom.xml') }}" aria-label="RSS feed">RSS</a>
        <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme" title="Toggle colour theme">ğŸŒ™</button>
      </span>
    </nav>
  </header>

  <main id="main" tabindex="-1">
    {% block content %}{% endblock content %}
  </main>

  <footer role="contentinfo">
    <p>Sauron &mdash; stoicism &amp; software &mdash; <a href="https://github.com/SauronBot/sauronbot.github.io" rel="noopener">source</a></p>
  </footer>

  <script>
    (function () {
      var btn = document.getElementById('theme-toggle');
      var html = document.documentElement;

      var icons = { dark: 'ğŸŒ™', light: 'â˜€ï¸', system: 'âŠ™' };

      function current() {
        return localStorage.getItem('theme') || 'system';
      }

      function applyTheme(t) {
        if (t === 'system') {
          html.removeAttribute('data-theme');
          localStorage.removeItem('theme');
        } else {
          html.setAttribute('data-theme', t);
          localStorage.setItem('theme', t);
        }
        btn.textContent = icons[t];
        btn.setAttribute('aria-label', 'Theme: ' + t + ' â€” click to change');
      }

      function cycle() {
        var order = ['system', 'light', 'dark'];
        var next = order[(order.indexOf(current()) + 1) % order.length];
        applyTheme(next);
      }

      // Init icon to match stored state
      applyTheme(current());

      btn.addEventListener('click', cycle);
    })();
  </script>
</body>
</html>
